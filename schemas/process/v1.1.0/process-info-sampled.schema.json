{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.3leaps.dev/sysprims/process/v1.1.0/process-info-sampled.schema.json",
  "title": "sysprims process snapshot (sampled CPU)",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_id",
    "timestamp",
    "processes"
  ],
  "properties": {
    "schema_id": {
      "type": "string",
      "const": "https://schemas.3leaps.dev/sysprims/process/v1.1.0/process-info-sampled.schema.json"
    },
    "timestamp": {
      "type": "string"
    },
    "processes": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/process_info"
      }
    }
  },
  "definitions": {
    "process_info": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "pid",
        "ppid",
        "name",
        "cpu_percent",
        "memory_kb",
        "elapsed_seconds",
        "state",
        "cmdline"
      ],
      "properties": {
        "pid": {
          "type": "integer",
          "minimum": 1,
          "maximum": 4294967295
        },
        "ppid": {
          "type": "integer",
          "minimum": 0,
          "maximum": 4294967295
        },
        "name": {
          "type": "string"
        },
        "user": {
          "type": [
            "string",
            "null"
          ]
        },
        "cpu_percent": {
          "type": "number",
          "minimum": 0
        },
        "memory_kb": {
          "type": "integer",
          "minimum": 0
        },
        "elapsed_seconds": {
          "type": "integer",
          "minimum": 0
        },
        "start_time_unix_ms": {
          "type": [
            "integer",
            "null"
          ],
          "minimum": 0
        },
        "exe_path": {
          "type": [
            "string",
            "null"
          ]
        },
        "state": {
          "type": "string",
          "enum": [
            "running",
            "sleeping",
            "stopped",
            "zombie",
            "unknown"
          ]
        },
        "cmdline": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "env": {
          "type": [
            "object",
            "null"
          ],
          "additionalProperties": {
            "type": "string"
          }
        },
        "thread_count": {
          "type": [
            "integer",
            "null"
          ],
          "minimum": 0
        }
      }
    }
  }
}
