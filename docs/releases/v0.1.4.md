# sysprims v0.1.4

**Release Date:** 2026-01-22
**Status:** TypeScript Language Bindings Release

## Summary

Node.js developers can now integrate sysprims directly. This release delivers koffi-based TypeScript bindings with cross-platform support, continuing the language bindings story after Go (v0.1.3).

## Highlights

- **TypeScript Bindings**: First-class Node.js support via koffi FFI
- **Cross-Platform**: linux-amd64, linux-arm64, darwin-arm64, windows-amd64
- **ABI Verification**: Library loader validates ABI version at startup
- **CI Coverage**: Native ARM64 Linux testing added to CI matrix

## TypeScript Bindings

### Installation

```bash
npm install @3leaps/sysprims
```

### Usage

```typescript
import { procGet, selfPGID, selfSID } from "@3leaps/sysprims";

// Get process info by PID
const proc = procGet(process.pid);
console.log(`Process ${proc.pid}: ${proc.name}`);

// Get current process group/session IDs (Unix)
const pgid = selfPGID();
const sid = selfSID();
```

### API

| Function       | Description                                   |
| -------------- | --------------------------------------------- |
| `procGet(pid)` | Get process info by PID (returns parsed JSON) |
| `selfPGID()`   | Get current process group ID (Unix only)      |
| `selfSID()`    | Get current session ID (Unix only)            |

### Requirements

- Node.js 18+
- glibc-based Linux (musl/Alpine not supported)

### How It Works

The TypeScript bindings use [koffi](https://koffi.dev/) to call the sysprims C-ABI shared library. At load time, the binding:

1. Detects the current platform
2. Loads the appropriate shared library from `_lib/<platform>/`
3. Verifies ABI version matches expected value
4. Exposes typed functions to JavaScript

## Changes

### Added

- **TypeScript Bindings** (`bindings/typescript/sysprims/`)
  - koffi-based FFI for Node.js 18+
  - Cross-platform: linux-amd64, linux-arm64, darwin-arm64, windows-amd64
  - ABI version verification on library load
  - CI validates TypeScript bindings on all supported platforms

- **Linux ARM64 CI Coverage**
  - Added linux-arm64 runner to CI matrix for native ARM64 testing

### Changed

- **CI Platform Matrix**
  - Replaced darwin-amd64 (Intel Mac) with linux-arm64
  - Intel Mac runners deprecated by GitHub Actions
  - TypeScript CI: linux-amd64, linux-arm64, darwin-arm64, windows-amd64

### Fixed

- **Windows TypeScript Tests**
  - Cross-platform build scripts replace Unix-only shell commands
  - `npm run test:ci` now works on Windows runners

- **Parallel Test Flakiness**
  - Added atomic counter to `unique_marker()` in tree_escape tests
  - Prevents collisions when tests run in parallel with same PID/timestamp

## Platforms

| Platform            | CLI | Go Bindings | TypeScript Bindings |
| ------------------- | --- | ----------- | ------------------- |
| Linux x64 (glibc)   | yes | yes         | yes                 |
| Linux x64 (musl)    | yes | yes         | no                  |
| Linux arm64 (glibc) | yes | yes         | yes                 |
| Linux arm64 (musl)  | yes | yes         | no                  |
| macOS x64           | yes | yes         | no (deprecated)     |
| macOS arm64         | yes | yes         | yes                 |
| Windows x64         | yes | yes         | yes                 |

**Note:** TypeScript bindings require glibc. Linux musl (Alpine) is not supported.

## Verification

Verify this release with the signed checksums:

```bash
# Download release and verification files
curl -LO https://github.com/3leaps/sysprims/releases/download/v0.1.4/SHA256SUMS
curl -LO https://github.com/3leaps/sysprims/releases/download/v0.1.4/SHA256SUMS.minisig
curl -LO https://github.com/3leaps/sysprims/releases/download/v0.1.4/sysprims-minisign.pub

# Verify signature
minisign -Vm SHA256SUMS -p sysprims-minisign.pub

# Verify checksums
shasum -a 256 -c SHA256SUMS --ignore-missing
```

## Next Release

v0.1.5+ will continue toward:

- Python bindings (cffi + wheel packaging)
- Additional TypeScript API surface
